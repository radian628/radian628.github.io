---
title: Amogus Tiling  
layout: ../../layouts/blog.astro
---
# Amogus Tiling Code Golf

This is the Amogus tiling.

```
| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_
  |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |   
    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___
|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___
 _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___
|   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      
|_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  
| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_
  |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |   
    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___
|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___
 _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___
|   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      
|_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  
| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_
  |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |   
    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___
|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___
 _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___
|   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      
|_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  
| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_
  |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |   
    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___
|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___
 _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___
|   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      
|_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  
| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_
  |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |   
    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___
|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___
 _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___
|   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      
|_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  
| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_
  |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |   
    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___
|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___
 _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___
|   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      
|_      |   |_____|  ___|  _|___    |     |_| |_| |  _  |_      |   |_____|  ___|  _|___    |     |_| |_| |  _  
```

The following consists of my attempts at code-golfing the Amogus tiling.
My first attempt consisted of me creating a "unit cell" of the Amogus tiling as a reference implementation.
This "unit cell" can be tiled in the 2D plane in a rectangular grid without
having to shift the rows nor the columns.

```js
function tileAmogus(x, y) {
  const amogus = `| |  _  |_      |   |___ _|  ___|  _|___    |     |_| |_
  |_| |_| |  _  |_      |   |___ _|  ___|  _|___    |   
    |     |_| |_| |  _  |_      |   |___ _|  ___|  _|___
|  _|___    |     |_| |_| |  _  |_      |   |___ _|  ___
 _|  ___|  _|___    |     |_| |_| |  _  |_      |   |___
|   |_____|  ___|  _|___    |     |_| |_| |  _  |_      
|_      |   |_____|  ___|  _|___    |     |_| |_| |  _  `.split('\n');
		
	const range = n => new Array(n).fill(0).map((e, i) => i);

	let out = "";

	for (let i in range(y)) {
		out += amogus.map(s => {
			let row = "";
			for (let j in range(x)) row += s;
			return row;
		}).join("\n") + "\n"
	}

	return out;
}
console.log(tileAmogus(2,6));
```

My next attempt had two major improvements:
1. I switched to a much smaller unit cell which *does* require shifting each column.
2. I heavily optimized the looping code to loop over a 2D grid more efficiently.

```js
function a(xs, ys) {
  let p = `| |  _  
  |_| |_
    |   
|  _|___
 _|  ___
|   |___
|_      `.split('\n');
        
    let r = n => [..."".padEnd(n)];

    let o = "";

    return r(xs * ys).map((e,i) => p[(Math.floor(i/ys)+6*((i%xs)>>3))%7][(i%xs)&7]+(i%xs?"":"\n")).join("");
}
console.log(a(40,20));
```

- Removed the newlines from the unit cell code because I'm doing that anyway.
- Inlined a bunch of things from earlier

```js
let a=(u, v)=>[..."".padEnd(u*v)].map((e,i) => `| |  _    |_| |_    |   |  _|___ _|  ___|   |___|_      `[((((i/u)|0)+6*((i%u)>>3))%7)*8+((i%u)&7)]+(i%u?"":"\n")).join("");
```

Slight modifications to the indexing code.

```js
let a=(u, v)=>[..."".padEnd(u*v)].map((e,i) => `| |  _    |_| |_    |   |  _|___ _|  ___|   |___|_      `[(((i/u)|0)*8+48*((i%u)>>3))%56+((i%u)&7)]+(i%u?"":"\n")).join("");
```

The golfed amogus function:
```js

(u,v)=>[..."".padEnd(u*v)].map((e,i)=>`| |  _    |_| |_    |   |  _|___ _|  ___|   |___|_      `[((((i/u)|0)+6*((i%u)>>3))%7)*8+((i%u)&7)]+(i%u?"":"\n")).join("")
```

Fixed version
```js

(u,v)=>[..."".padEnd(u*v)].map((e,i)=>(i%u?"":"\n")+`| |  _    |_| |_    |   |  _|___ _|  ___|   |___|_      `[((((i/u)|0)+6*((i%u)>>3))%7)*8+((i%u)&7)]).join("")

```

Big development! `Array` constructor is more compact than `padEnd`.
```js

(u,v)=>Array(u*v).fill().map((e,i)=>(i%u?"":"\n")+"| |  _    |_| |_    |   |  _|___ _|  ___|   |___|_      "[((((i/u)|0)+6*((i%u)>>3))%7)*8+((i%u)&7)]).join("")

```

Another big development! The string contains three characters:
- Space (` `)
- Underscore (`_`)
- Pipe (`|`)

Therefore we can:
1. Represent the pattern as a number in the highest base possible (base 16)
2. Reinterpret it as a base 3 number (all digits are 0, 1, or 2)
3. Map 0 to Space, 1 to Underscore, and 2 to Pipe. 

```js
(u,v)=>Array(u*v).fill().map((e,i)=>(i%u?"":"\n")+" _|"[0x14144e04a81960d922ff00dn.toString(3)[((((i/u)|0)+6*((i%u)>>3))%7)*8+((i%u)&7)]]).join("")
```

This is the unit cell number.

```js
0x14144e04a81960d922ff00dn
```

Crappy reduce method (168 chars)
```js
(u,v)=>Array(u*v).fill().reduce(([s,x,y],e,i)=>[s+(x?"":"\n")+" _|"[0x14144e04a81960d922ff00dn.toString(3)[(x&7)+((((x/8)|0)*6+y)%7)*8]],(x+1)%u,y+(u-x==1)],["",0,0])[0]
```

Rather than using a 2D unit cell, we can instead draw the Amogus tiling a row at a time.
We can then shift the row over by a fixed amount each time.

Single row pattern: `|  ___|  _|___    |     |_| |_| |  _  |_      |   |___ _`

Offset: `48`

As decimal: `358725889429253130858610645n`

As hex: `0x128bb296eab2f01aaf13fd5n`

129 chars
```js
(u,v)=>Array(u*v).fill().map((e,i)=>(i%u?"":"\n")+" _|"[0x128bb296eab2f01aaf13fd5n.toString(3)[((i%u)+48*((i/u)|0))%56]]).join("")
```

A bunch more optimizations using bitwise stupidity

129
```js

(u,v)=>Array(u*v).fill().map((e,i)=>(i%u?"":`
`)+" _|"[0x128bb296eab2f01aaf13fd5n.toString(3)[((i%u)+48*((i/u)|0))%56]]).join("")
```

127
```js
(u,v)=>Array(u*v).fill().map((e,i)=>(i%u?"":`
`)+" _|"[0x128bb296eab2f01aaf13fd5n.toString(3)[((i%u)+48*~~(i/u))%56]]).join("")
```

125
```js
(u,v)=>Array(u*v).fill().map((e,i)=>(i%u?"":`
`)+" _|"[0x128bb296eab2f01aaf13fd5n.toString(3)[(i%u+48*~~(i/u))%56]]).join("")
```

Turns out a classical `for` loop is actually more compact!

122
```js
(u,v)=>{for(i=0,s="";i<u*v;)s+=(i%u?"":`
`)+" _|"[0x128bb296eab2f01aaf13fd5n.toString(3)[(i%u+48*~~(i++/u))%56]];return s}
```

This wacky `replace` method is the same size.

122
```js
(u,v)=>"".padEnd(u*v).replace(/./g,(_,i)=>(i%u?"":`
`)+" _|"[0x128bb296eab2f01aaf13fd5n.toString(3)[(i%u+48*~~(i/u))%56]])
```

122
```js
(u,v)=>(Array(u*v)+1).replace(/./g,(_,i)=>(i%u?"":`
`)+" _|"[0x128bb296eab2f01aaf13fd5n.toString(3)[(i%u+48*~~(i/u))%56]])
```

119 (bigint input) (by Alex_x90)
```js
(u,v)=>{for(i=0n,s="";i<u*v;)s+=(i%u?"":`
`)+" _|"[0x4560200060422626002005642542n>>(i%u+i++/u*48n)%56n*2n&3n];return s}
```

118 base 3 bigint
```js
(u,v)=>{for(i=0n,s="";i<u*v;)s+=(i%u?"":`
`)+" _|"[(0x128bb296eab2f01aaf13fd5n/3n**((i%u+i++/u*8n)%56n))%3n];return s}
```

